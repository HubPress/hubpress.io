<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <title>Raspberry Pi wireless access point - an approach</title>
    <meta name="description" content="" />

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" href="https://manelvf.github.io/blog/favicon.ico">

    <link rel="stylesheet" type="text/css" href="//manelvf.github.io/blog/themes/casper/assets/css/screen.css?v=1501433943820" />
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400" />

    <link rel="canonical" href="https://manelvf.github.io/blog/2017/07/30/Raspberry-Pi-wireless-access-point-an-approach.html" />
    <meta name="referrer" content="origin" />
    
    <meta property="og:site_name" content="The Fallen Apples" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Raspberry Pi wireless access point - an approach" />
    <meta property="og:description" content="The need There are many cases it&amp;#8217;s advisable to create a point-of-access using a PI, with or without connection to an external network. The case for a access point with a connection to an external network (usually with internet access) is comparable to use a Pi as a" />
    <meta property="og:url" content="https://manelvf.github.io/blog/2017/07/30/Raspberry-Pi-wireless-access-point-an-approach.html" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Raspberry Pi wireless access point - an approach" />
    <meta name="twitter:description" content="The need There are many cases it&amp;#8217;s advisable to create a point-of-access using a PI, with or without connection to an external network. The case for a access point with a connection to an external network (usually with internet access) is comparable to use a Pi as a" />
    <meta name="twitter:url" content="https://manelvf.github.io/blog/2017/07/30/Raspberry-Pi-wireless-access-point-an-approach.html" />
    
    <script type="application/ld+json">
null
    </script>

    <meta name="generator" content="HubPress" />
    <link rel="alternate" type="application/rss+xml" title="The Fallen Apples" href="https://manelvf.github.io/blog/rss/" />
</head>
<body class="post-template nav-closed">

    

    <div class="site-wrapper">

        


<header class="main-header post-head no-cover">
    <nav class="main-nav  clearfix">
        
    </nav>
</header>

<main class="content" role="main">
    <article class="post">

        <header class="post-header">
            <h1 class="post-title">Raspberry Pi wireless access point - an approach</h1>
            <section class="post-meta">
                <time class="post-date" datetime="2017-07-30">30 July 2017</time> 
            </section>
        </header>

        <section class="post-content">
            <div class="sect1">
<h2 id="_the_need">The need</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There are many cases it&#8217;s advisable to create a point-of-access using a PI, with or without connection to an external network. The case for a access point with a connection to an external network (usually with internet access) is comparable to use a Pi as a router and I am not going to cover it here. I&#8217;ll focus on a point-of-access that can be used as a web server or any other kind of network service provider (FTP, email, etc&#8230;&#8203;).</p>
</div>
<div class="paragraph">
<p>I used the following setup in latest Makers Faire, but I cannot advise you to use a wireless point-of-access in those kind of events. There are many sources of interference and the experience can be really bad, as our signal blocks other nearby signal, specially the always beloved organization wifi with internet access. I think this setup is more useful for small events and places without wireless internet connection.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_pis">The PIs</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For my setup, I used a <strong>Pi3</strong>, as it&#8217;s convenient thanks to the included embedded wifi. It&#8217;s possible to use any other Pi with a wireless network adapter, as the resource usage is really small.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_dependencies">Dependencies</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For this tutorial, I&#8217;ll use <strong>Raspbian</strong>, and two packages are needed for this:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>sudo apt-get install dnsmasq udhcpd</pre>
</div>
</div>
<div class="paragraph">
<p><code>dnsmasq</code> will manage DNS, so we can assign domains at random (yes, this could be used for phising for malicious people using fake internet hot-spots).</p>
</div>
<div class="paragraph">
<p><code>udhcpd</code> will assign IP addresses to the clients that connect to our servers. There are tutorial that recommend other packages, but this worked well for me.</p>
</div>
<div class="paragraph">
<p>Now let&#8217;s see how we can put all this stuff together.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_setup_your_network">Setup your network</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_interfaces">Interfaces</h3>
<div class="paragraph">
<p>First step, in order to make the network interface works in it&#8217;s own network, we add these lines to the <code>/etc/network/interfaces</code> file.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>auto wlan0
allow-hotplug wlan0
iface wlan0 inet static
  address 192.168.42.1
  netmask 255.255.255.0
  network 192.168.42.0
  broadcast 192.168.1.255</pre>
</div>
</div>
<div class="paragraph">
<p>Notice that the address 192.168.42&#8230;&#8203; is arbitrary. It could be any other as long as it doesn&#8217;t conflict with any other existing network interface, i.e., 192.168.1.XXX. Notice also that interface line should be configured as <code>static</code>, even  Debian docs suggest that <code>dhcp</code> should be used. In this setup, the <code>udhcp</code> daemon will take care of that assignation.</p>
</div>
</div>
<div class="sect2">
<h3 id="_dnsmasq">DNSmasq</h3>
<div class="paragraph">
<p>Adding these lines at the end of <code>/etc/dnsmasq/dnsmasq.conf</code> will connect any domain</p>
</div>
<div class="literalblock">
<div class="content">
<pre>interface=wlan0
bind-dynamic
dhcp-range=192.168.42.1,192.168.42.254,255.255.255.0,24h
dhcp-option=option:router,192.168.42.1
# no-hosts</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>address=/#/192.168.42.1</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_udhcp">UDHCP</h3>
<div class="paragraph">
<p>In <code>etc/udhcpd/udhcpd.conf</code>, modify the default assignation ranges, and attach the wireless interface to the deamon:</p>
</div>
<div class="literalblock">
<div class="content">
<pre># The start and end of the IP lease block</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>start		192.168.42.20	#default: 192.168.0.20
end		192.168.42.254	#default: 192.168.0.254</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre># The interface that udhcpd will use</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>interface wlan0</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_daemon_startup">Daemon startup</h3>
<div class="paragraph">
<p>It might happen that these daemons are authomatically started after installing the packages. Then you can check status using <code>systemctl</code>, i.e:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>sudo systemctl status dnsmasq</pre>
</div>
</div>
<div class="paragraph">
<p>And start or stop them at will:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>sudo systemctl start udhcpd</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_server_application">Server application</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now, if everything goes smooth, all requests from the clients that connect to our access point newwork will point to our server. The easiest way to test it, it&#8217;s to install an existing web server, like <code>nginx</code>, that serves a very simple default static HTML webpage. It&#8217;s also possible to run a basic python server. For the Maker&#8217;s Faire, I used a combination of both worlds: a python script that was executed periodically using a cron task.</p>
</div>
<div class="paragraph">
<p>The script check the temperature and humidity from a Pimoroni Hat sensors and wrote static files that were served using <code>nginx</code>. More complex setups, like a custom web server, are also possible, of course, but are out of the scope of this document. Maybe that will be material for more tutorials.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_conclusion">Conclusion</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There are many tutorials for this kind of setup in the web, most of them need some tayloring, as probably this one. Make use of this not as a full reference but as a starting point if you like. And please don&#8217;t doubt in reporting possible mistakes or omissions ;)</p>
</div>
<div class="paragraph">
<p><strong>Bonus</strong>: you can check the repo with source files in <a href="https://github.com/manelvf/access_point" class="bare">https://github.com/manelvf/access_point</a></p>
</div>
</div>
</div>
        </section>

        <footer class="post-footer">


            <figure class="author-image">
                <a class="img" href="https://manelvf.github.io/blog/author/manelvf/" style="background-image: url(https://avatars2.githubusercontent.com/u/135327?v&#x3D;4)"><span class="hidden">Manel Vilar's Picture</span></a>
            </figure>

            <section class="author">
                <h4><a href="https://manelvf.github.io/blog/author/manelvf/">Manel Vilar</a></h4>

                    <p>Working in Open Source in my spare time, mostly for fun. </p>
                <div class="author-meta">
                    <span class="author-location icon-location">Berlin</span>
                    <span class="author-link icon-link"><a href="manelvf.github.io">manelvf.github.io</a></span>
                </div>
            </section>


            <section class="share">
                <h4>Share this post</h4>
                <a class="icon-twitter" href="https://twitter.com/intent/tweet?text=Raspberry%20Pi%20wireless%20access%20point%20-%20an%20approach&amp;url=https://manelvf.github.io/blog/2017/07/30/Raspberry-Pi-wireless-access-point-an-approach.html"
                    onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <span class="hidden">Twitter</span>
                </a>
                <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://manelvf.github.io/blog/2017/07/30/Raspberry-Pi-wireless-access-point-an-approach.html"
                    onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <span class="hidden">Facebook</span>
                </a>
                <a class="icon-google-plus" href="https://plus.google.com/share?url=https://manelvf.github.io/blog/2017/07/30/Raspberry-Pi-wireless-access-point-an-approach.html"
                   onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    <span class="hidden">Google+</span>
                </a>
            </section>

        </footer>


        <section class="post-comments">
          <div id="disqus_thread"></div>
          <script type="text/javascript">
          var disqus_shortname = 'manelvfgithubio'; // required: replace example with your forum shortname
          /* * * DON'T EDIT BELOW THIS LINE * * */
          (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
          })();
          </script>
          <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
          <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        </section>


    </article>

</main>

<aside class="read-next">
</aside>



        <footer class="site-footer clearfix">
            <section class="copyright"><a href="https://manelvf.github.io/blog">The Fallen Apples</a> &copy; 2017</section>
            <section class="poweredby">Proudly published with <a href="http://hubpress.io">HubPress</a></section>
        </footer>

    </div>

    <script type="text/javascript" src="https://code.jquery.com/jquery-1.12.0.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js?v="></script> <script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.9.0/moment-with-locales.min.js?v="></script> <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js?v="></script> 
      <script type="text/javascript">
        jQuery( document ).ready(function() {
          // change date with ago
          jQuery('ago.ago').each(function(){
            var element = jQuery(this).parent();
            element.html( moment(element.text()).fromNow());
          });
        });

        hljs.initHighlightingOnLoad();
      </script>

    <script type="text/javascript" src="//manelvf.github.io/blog/themes/casper/assets/js/jquery.fitvids.js?v=1501433943820"></script>
    <script type="text/javascript" src="//manelvf.github.io/blog/themes/casper/assets/js/index.js?v=1501433943820"></script>

    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-34164255-1', 'auto');
    ga('send', 'pageview');

    </script>
</body>
</html>
